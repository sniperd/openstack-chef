[DEFAULT]
cert_file = /etc/swift/cert.crt
key_file = /etc/swift/cert.key
bind_port = 8080
workers = 8
user = swift
log_name = swift
log_facility = LOG_LOCAL0
log_level = INFO

[pipeline:main]
pipeline = healthcheck cache <%= node.swift.auth.auth_type -%> proxy-server

[app:proxy-server]
use = egg:swift#proxy
allow_account_management = true
account_autocreate = true
set log_name = proxy-server
set log_facility = LOG_LOCAL0
set log_level = INFO
set access_log_name = proxy-server
set access_log_facility = LOG_LOCAL0
set access_log_level = INFO

<% if node.swift.auth.auth_type == "tempauth" %>

[filter:tempauth]
use = egg:swift#tempauth
user_system_root = <%= node.swift.auth.password -%> .admin https://<%= node.ipaddress -%>:8080/v1/AUTH_system

<% elsif node.swift.auth.auth_type == "swauth" %>

[filter:swauth]
use = egg:swauth#swauth
set log_name = swauth
super_admin_key = <%= node.swift.auth.password -%>

<% end %>

[filter:healthcheck]
use = egg:swift#healthcheck

[filter:cache]
use = egg:swift#memcache
memcache_servers = <%= node.ipaddress -%>:11211

